# Анализ остатков товаров на складе

## Краткое описание
Данная задача была выполнена в рамках реальной оптимизации процесса для упрощения аналитической работы. Данные, представленные в Excel-файле "Остатки", содержат информацию за прошедший период.

Задача:
- Привести данные в читаемый вид для дальнейшей обработки;
- Выбрать данные по определенному складу;
- Выделить когорты по товарам и посчитать необходимые метрики;
- Загрузить итоговые таблицы с аналитикой на отдельные Excel-листы;
- По каждой когорте подготовить список товаров для дальнейшей работы.

Весь процесс выполнялся ранее вручную через Excel, но, в связи с тем, что данная работа выполняется ежемесячно и занимает слишком много времени, то было принято решение создать код для автоматической обработки.

Результаты:
- Настроен алгоритм, автоматически обрабатывающий данные для ежемесячного использования;
- Данный код экономит 2 дня ручной работы аналитика компании.

Исходные данные можно посмотреть в файле "Остатки.xlsx". Итоговые таблицы находятся в папке "Files"

Стэк:

- Python
- JupiterHub
- Excel

## Библиотеки для работы с Excel

```
import pandas as pd
import numpy as np
import os
import openpyxl

from openpyxl import Workbook
from openpyxl.worksheet.filters import (FilterColumn, CustomFilter, CustomFilters, DateGroupItem, Filters)
from openpyxl.worksheet.table import Table, TableStyleInfo
from openpyxl.styles import NamedStyle, Font, Border, Side, Alignment
from openpyxl.utils.cell import get_column_letter
```

## Форматирование данных и получение основных метрик

На первом этапе преобразуем файл Excel для дальнейшего чтения и редактирования. Убираем ненужные строки и слобцы, а также исключаем строки с подзаголовками, чтобы убрать задвоение цифр. Считаем нужные показатели и выводим все в таблицу.

```
itog_UGD = pd.DataFrame({'Склад': ['Угданский - масло', 'Угданский - запасные части', 'Итого', 'Продажи за ГОД в ценах с/с', 'Коэфф. оборачиваемости товара'], 
                    'Шт.': [Quanity_oil, Quanity_prod, Quanity_oil+Quanity_prod, Sales_oil+Sales_prod, '0'], 
                    'Сумма.': [Sum_oil, Sum_prod, Sum_oil+Sum_prod, Sales_sum_oil+Sales_sum_prod, (Sales_sum_oil+Sales_sum_prod)/((Sum_begin_oil+Sum_begin_prod+Sum_prod+Sum_oil)/2)]})
itog_UGD = itog_UGD.set_index('Склад').round(2)

itog_UGD
```
![image](https://user-images.githubusercontent.com/100629361/232334909-89fa0edc-b749-462c-8d12-ce6bf5898878.png)

После чего можем применить функции для дальнейшей автоматической обработки данных.
```
# Выполняем функции для создания таблиц, внесения всех листов в excel-файл
itog = itog_UGD
table = Ugdan
File = ('Угдан_апрель.xlsx')
create_table(File)
groups(table, File)
add_groups(table, File)
decor_file(File)
```

## Анализ групп

Второй этап подразумевает разбиение товаров на группы для дальнейшей детальной работы. Это осуществляется с помощью функции "groups" и "add_groups".

Пример таблицы с информацией по группам:

![image](https://user-images.githubusercontent.com/100629361/230100594-7077a15d-0271-467f-ac62-cb97b77609b7.png)

Вышеуказанные функции создают новые df и добавляют в один Excel файл.

## Оформление таблиц
Для оформления внешнего вида таблиц используем функцию "decor_file". Изменения применяются на все листы в файле.


